var sharded=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,o=n;return[o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]]].join("")}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function u(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,u)}a((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),s="_counter_shards_",u="FIRESTORE_COUNTER_SHARD_ID",a=function(){function t(t,e){this.doc=t,this.field=e,this.db=null,this.shardId="",this.shards={},this.notifyPromise=null,this.db=t.firestore,this.shardId=function(t){var e=new RegExp("(?:^|; )"+encodeURIComponent(t)+"=([^;]*)").exec(document.cookie);if(e)return e[1];var n=i.v4(),r=new Date;r.setTime(r.getTime()+2592e6);var o="; expires="+r.toUTCString();return document.cookie=encodeURIComponent(t)+"="+n+o+"; path=/",n}(u);var n=t.collection(s);this.shards[t.path]=0,this.shards[n.doc(this.shardId).path]=0,this.shards[n.doc("\t"+this.shardId.substr(0,4)).path]=0,this.shards[n.doc("\t\t"+this.shardId.substr(0,3)).path]=0,this.shards[n.doc("\t\t\t"+this.shardId.substr(0,2)).path]=0,this.shards[n.doc("\t\t\t\t"+this.shardId.substr(0,1)).path]=0}return t.prototype.get=function(t){return r(this,void 0,void 0,function(){var e,n=this;return o(this,function(i){switch(i.label){case 0:return e=Object.keys(this.shards).map(function(e){return r(n,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,this.db.doc(e).get(t)];case 1:return[2,n.sent().get(this.field)||0]}})})}),[4,Promise.all(e)];case 1:return[2,i.sent().reduce(function(t,e){return t+e},0)]}})})},t.prototype.onSnapshot=function(t){var e=this;Object.keys(this.shards).forEach(function(n){e.db.doc(n).onSnapshot(function(n){e.shards[n.ref.path]=n.get(e.field)||0,null===e.notifyPromise&&(e.notifyPromise=function(t){return r(this,void 0,void 0,function(){var e=this;return o(this,function(n){return[2,new Promise(function(n){return r(e,void 0,void 0,function(){var e=this;return o(this,function(i){return setTimeout(function(){return r(e,void 0,void 0,function(){var e;return o(this,function(r){return e=t(),n(e),[2]})})},0),[2]})})})]})})}(function(){var n=Object.values(e.shards).reduce(function(t,e){return t+e},0);t({exists:!0,data:function(){return n}}),e.notifyPromise=null}))})})},t.prototype.incrementBy=function(t){var e=this.field.split(".").reverse().reduce(function(t,e){var n;return(n={})[e]=t,n},t);return this.doc.collection(s).doc(this.shardId).set(e,{merge:!0})},t.prototype.shard=function(){return this.doc.collection(s).doc(this.shardId)},t}();e.Counter=a},function(t,e,n){var r=n(4),o=n(5),i=o;i.v1=r,i.v4=o,t.exports=i},function(t,e,n){var r,o,i=n(0),s=n(1),u=0,a=0;t.exports=function(t,e,n){var c=e&&n||0,d=e||[],f=(t=t||{}).node||r,l=void 0!==t.clockseq?t.clockseq:o;if(null==f||null==l){var h=i();null==f&&(f=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==l&&(l=o=16383&(h[6]<<8|h[7]))}var p=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:a+1,y=p-u+(v-a)/1e4;if(y<0&&void 0===t.clockseq&&(l=l+1&16383),(y<0||p>u)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=p,a=v,o=l;var b=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;d[c++]=b>>>24&255,d[c++]=b>>>16&255,d[c++]=b>>>8&255,d[c++]=255&b;var m=p/4294967296*1e4&268435455;d[c++]=m>>>8&255,d[c++]=255&m,d[c++]=m>>>24&15|16,d[c++]=m>>>16&255,d[c++]=l>>>8|128,d[c++]=255&l;for(var g=0;g<6;++g)d[c+g]=f[g];return e||s(d)}},function(t,e,n){var r=n(0),o=n(1);t.exports=function(t,e,n){var i=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var u=0;u<16;++u)e[i+u]=s[u];return e||o(s)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaGFyZGVkL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NoYXJkZWQvLi9ub2RlX21vZHVsZXMvdXVpZC9saWIvcm5nLWJyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vc2hhcmRlZC8uL25vZGVfbW9kdWxlcy91dWlkL2xpYi9ieXRlc1RvVXVpZC5qcyIsIndlYnBhY2s6Ly9zaGFyZGVkLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3NoYXJkZWQvLi9ub2RlX21vZHVsZXMvdXVpZC9pbmRleC5qcyIsIndlYnBhY2s6Ly9zaGFyZGVkLy4vbm9kZV9tb2R1bGVzL3V1aWQvdjEuanMiLCJ3ZWJwYWNrOi8vc2hhcmRlZC8uL25vZGVfbW9kdWxlcy91dWlkL3Y0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZ2V0UmFuZG9tVmFsdWVzIiwiY3J5cHRvIiwid2luZG93IiwibXNDcnlwdG8iLCJybmRzOCIsIlVpbnQ4QXJyYXkiLCJybmRzIiwiQXJyYXkiLCJNYXRoIiwicmFuZG9tIiwiYnl0ZVRvSGV4IiwidG9TdHJpbmciLCJzdWJzdHIiLCJidWYiLCJvZmZzZXQiLCJidGgiLCJqb2luIiwidXVpZCIsIlNIQVJEX0NPTExFQ1RJT05fSUQiLCJDT09LSUVfTkFNRSIsIkNvdW50ZXIiLCJkb2MiLCJmaWVsZCIsInRoaXMiLCJkYiIsInNoYXJkSWQiLCJzaGFyZHMiLCJub3RpZnlQcm9taXNlIiwiZmlyZXN0b3JlIiwiY29va2llIiwicmVzdWx0IiwiUmVnRXhwIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZXhlYyIsImRvY3VtZW50IiwidjQiLCJkYXRlIiwiRGF0ZSIsInNldFRpbWUiLCJnZXRUaW1lIiwiZXhwaXJlcyIsInRvVVRDU3RyaW5nIiwiZ2V0U2hhcmRJZCIsInNoYXJkc1JlZiIsImNvbGxlY3Rpb24iLCJwYXRoIiwib3B0aW9ucyIsInZhbHVlUHJvbWlzZXMiLCJrZXlzIiwibWFwIiwiX19hd2FpdGVyIiwiX3RoaXMiLCJfYSIsInNlbnQiLCJQcm9taXNlIiwiYWxsIiwicmVkdWNlIiwiYSIsImIiLCJvblNuYXBzaG90Iiwib2JzZXJ2YWJsZSIsImZvckVhY2giLCJzbmFwIiwicmVmIiwiZnVuYyIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2NoZWR1bGUiLCJzdW0iLCJ2YWx1ZXMiLCJleGlzdHMiLCJkYXRhIiwiaW5jcmVtZW50QnkiLCJ2YWwiLCJ1cGRhdGUiLCJzcGxpdCIsInJldmVyc2UiLCJzZXQiLCJtZXJnZSIsInNoYXJkIiwidjEiLCJfbm9kZUlkIiwiX2Nsb2Nrc2VxIiwicm5nIiwiYnl0ZXNUb1V1aWQiLCJfbGFzdE1TZWNzIiwiX2xhc3ROU2VjcyIsIm5vZGUiLCJjbG9ja3NlcSIsInVuZGVmaW5lZCIsInNlZWRCeXRlcyIsIm1zZWNzIiwibnNlY3MiLCJkdCIsIkVycm9yIiwidGwiLCJ0bWgiLCJpaSJdLCJtYXBwaW5ncyI6IndCQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFG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QUFBLEVBQUEsTUFDQUEsRUFBQSxNQUFBQSxFQUFBLE9BR0FPLEVBQ0EsUUFBQW9GLEVBQUEsRUFBb0JBLEVBQUEsS0FBU0EsRUFDN0JwRixFQUFBN0MsRUFBQWlJLEdBQUEzRixFQUFBMkYsR0FJQSxPQUFBcEYsR0FBQXVFLEVBQUE5RSIsImZpbGUiOiJzaGFyZGVkLWNvdW50ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMik7XG4iLCIvLyBVbmlxdWUgSUQgY3JlYXRpb24gcmVxdWlyZXMgYSBoaWdoIHF1YWxpdHkgcmFuZG9tICMgZ2VuZXJhdG9yLiAgSW4gdGhlXG4vLyBicm93c2VyIHRoaXMgaXMgYSBsaXR0bGUgY29tcGxpY2F0ZWQgZHVlIHRvIHVua25vd24gcXVhbGl0eSBvZiBNYXRoLnJhbmRvbSgpXG4vLyBhbmQgaW5jb25zaXN0ZW50IHN1cHBvcnQgZm9yIHRoZSBgY3J5cHRvYCBBUEkuICBXZSBkbyB0aGUgYmVzdCB3ZSBjYW4gdmlhXG4vLyBmZWF0dXJlLWRldGVjdGlvblxuXG4vLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG9cbi8vIGltcGxlbWVudGF0aW9uLiBBbHNvLCBmaW5kIHRoZSBjb21wbGV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBjcnlwdG8gb24gSUUxMS5cbnZhciBnZXRSYW5kb21WYWx1ZXMgPSAodHlwZW9mKGNyeXB0bykgIT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAodHlwZW9mKG1zQ3J5cHRvKSAhPSAndW5kZWZpbmVkJyAmJiB0eXBlb2Ygd2luZG93Lm1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyA9PSAnZnVuY3Rpb24nICYmIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKG1zQ3J5cHRvKSk7XG5cbmlmIChnZXRSYW5kb21WYWx1ZXMpIHtcbiAgLy8gV0hBVFdHIGNyeXB0byBSTkcgLSBodHRwOi8vd2lraS53aGF0d2cub3JnL3dpa2kvQ3J5cHRvXG4gIHZhciBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gd2hhdHdnUk5HKCkge1xuICAgIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG4gICAgcmV0dXJuIHJuZHM4O1xuICB9O1xufSBlbHNlIHtcbiAgLy8gTWF0aC5yYW5kb20oKS1iYXNlZCAoUk5HKVxuICAvL1xuICAvLyBJZiBhbGwgZWxzZSBmYWlscywgdXNlIE1hdGgucmFuZG9tKCkuICBJdCdzIGZhc3QsIGJ1dCBpcyBvZiB1bnNwZWNpZmllZFxuICAvLyBxdWFsaXR5LlxuICB2YXIgcm5kcyA9IG5ldyBBcnJheSgxNik7XG5cbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBtYXRoUk5HKCkge1xuICAgIGZvciAodmFyIGkgPSAwLCByOyBpIDwgMTY7IGkrKykge1xuICAgICAgaWYgKChpICYgMHgwMykgPT09IDApIHIgPSBNYXRoLnJhbmRvbSgpICogMHgxMDAwMDAwMDA7XG4gICAgICBybmRzW2ldID0gciA+Pj4gKChpICYgMHgwMykgPDwgMykgJiAweGZmO1xuICAgIH1cblxuICAgIHJldHVybiBybmRzO1xuICB9O1xufVxuIiwiLyoqXG4gKiBDb252ZXJ0IGFycmF5IG9mIDE2IGJ5dGUgdmFsdWVzIHRvIFVVSUQgc3RyaW5nIGZvcm1hdCBvZiB0aGUgZm9ybTpcbiAqIFhYWFhYWFhYLVhYWFgtWFhYWC1YWFhYLVhYWFhYWFhYWFhYWFxuICovXG52YXIgYnl0ZVRvSGV4ID0gW107XG5mb3IgKHZhciBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gIGJ5dGVUb0hleFtpXSA9IChpICsgMHgxMDApLnRvU3RyaW5nKDE2KS5zdWJzdHIoMSk7XG59XG5cbmZ1bmN0aW9uIGJ5dGVzVG9VdWlkKGJ1Ziwgb2Zmc2V0KSB7XG4gIHZhciBpID0gb2Zmc2V0IHx8IDA7XG4gIHZhciBidGggPSBieXRlVG9IZXg7XG4gIC8vIGpvaW4gdXNlZCB0byBmaXggbWVtb3J5IGlzc3VlIGNhdXNlZCBieSBjb25jYXRlbmF0aW9uOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvdjgvaXNzdWVzL2RldGFpbD9pZD0zMTc1I2M0XG4gIHJldHVybiAoW2J0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sIFxuXHRidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG5cdGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcblx0YnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSwgJy0nLFxuXHRidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG5cdGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sXG5cdGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sXG5cdGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV1dKS5qb2luKCcnKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBieXRlc1RvVXVpZDtcbiIsIi8qXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYW4gTUlULXN0eWxlXG4gKiBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgb3IgYXRcbiAqIGh0dHBzOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlULlxuICovXG5pbXBvcnQgKiBhcyB1dWlkIGZyb20gXCJ1dWlkXCI7XG5cbmNvbnN0IFNIQVJEX0NPTExFQ1RJT05fSUQgPSBcIl9jb3VudGVyX3NoYXJkc19cIjtcbmNvbnN0IENPT0tJRV9OQU1FID0gXCJGSVJFU1RPUkVfQ09VTlRFUl9TSEFSRF9JRFwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvdW50ZXJTbmFwc2hvdCB7XG4gIGV4aXN0czogYm9vbGVhbjtcbiAgZGF0YTogKCkgPT4gbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgQ291bnRlciB7XG4gIHByaXZhdGUgZGI6IGZpcmViYXNlLmZpcmVzdG9yZS5GaXJlc3RvcmUgPSBudWxsO1xuICBwcml2YXRlIHNoYXJkSWQgPSBcIlwiO1xuICBwcml2YXRlIHNoYXJkczogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSA9IHt9O1xuICBwcml2YXRlIG5vdGlmeVByb21pc2U6IFByb21pc2U8dm9pZD4gPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgZG9jOiBmaXJlYmFzZS5maXJlc3RvcmUuRG9jdW1lbnRSZWZlcmVuY2UsXG4gICAgcHJpdmF0ZSBmaWVsZDogc3RyaW5nXG4gICkge1xuICAgIHRoaXMuZGIgPSBkb2MuZmlyZXN0b3JlO1xuICAgIHRoaXMuc2hhcmRJZCA9IGdldFNoYXJkSWQoQ09PS0lFX05BTUUpO1xuXG4gICAgY29uc3Qgc2hhcmRzUmVmID0gZG9jLmNvbGxlY3Rpb24oU0hBUkRfQ09MTEVDVElPTl9JRCk7XG4gICAgdGhpcy5zaGFyZHNbZG9jLnBhdGhdID0gMDtcbiAgICB0aGlzLnNoYXJkc1tzaGFyZHNSZWYuZG9jKHRoaXMuc2hhcmRJZCkucGF0aF0gPSAwO1xuICAgIHRoaXMuc2hhcmRzW3NoYXJkc1JlZi5kb2MoXCJcXHRcIiArIHRoaXMuc2hhcmRJZC5zdWJzdHIoMCwgNCkpLnBhdGhdID0gMDtcbiAgICB0aGlzLnNoYXJkc1tzaGFyZHNSZWYuZG9jKFwiXFx0XFx0XCIgKyB0aGlzLnNoYXJkSWQuc3Vic3RyKDAsIDMpKS5wYXRoXSA9IDA7XG4gICAgdGhpcy5zaGFyZHNbc2hhcmRzUmVmLmRvYyhcIlxcdFxcdFxcdFwiICsgdGhpcy5zaGFyZElkLnN1YnN0cigwLCAyKSkucGF0aF0gPSAwO1xuICAgIHRoaXMuc2hhcmRzW3NoYXJkc1JlZi5kb2MoXCJcXHRcXHRcXHRcXHRcIiArIHRoaXMuc2hhcmRJZC5zdWJzdHIoMCwgMSkpLnBhdGhdID0gMDtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBnZXQob3B0aW9ucz86IGZpcmViYXNlLmZpcmVzdG9yZS5HZXRPcHRpb25zKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCB2YWx1ZVByb21pc2VzID0gT2JqZWN0LmtleXModGhpcy5zaGFyZHMpLm1hcChhc3luYyAocGF0aCkgPT4ge1xuICAgICAgY29uc3Qgc2hhcmQgPSBhd2FpdCB0aGlzLmRiLmRvYyhwYXRoKS5nZXQob3B0aW9ucyk7XG4gICAgICByZXR1cm4gPG51bWJlcj5zaGFyZC5nZXQodGhpcy5maWVsZCkgfHwgMDtcbiAgICB9KTtcbiAgICBjb25zdCB2YWx1ZXMgPSBhd2FpdCBQcm9taXNlLmFsbCh2YWx1ZVByb21pc2VzKTtcbiAgICByZXR1cm4gdmFsdWVzLnJlZHVjZSgoYSxiKSA9PiBhICsgYiwgMCk7XG4gIH1cblxuICBwdWJsaWMgb25TbmFwc2hvdChvYnNlcnZhYmxlOiAoKG5leHQ6IENvdW50ZXJTbmFwc2hvdCkgPT4gdm9pZCkpIHtcbiAgICBPYmplY3Qua2V5cyh0aGlzLnNoYXJkcykuZm9yRWFjaCgocGF0aCkgPT4ge1xuICAgICAgdGhpcy5kYlxuICAgICAgICAuZG9jKHBhdGgpXG4gICAgICAgIC5vblNuYXBzaG90KChzbmFwOiBmaXJlYmFzZS5maXJlc3RvcmUuRG9jdW1lbnRTbmFwc2hvdCkgPT4ge1xuICAgICAgICAgIHRoaXMuc2hhcmRzW3NuYXAucmVmLnBhdGhdID0gc25hcC5nZXQodGhpcy5maWVsZCkgfHwgMDtcbiAgICAgICAgICBpZiAodGhpcy5ub3RpZnlQcm9taXNlICE9PSBudWxsKSByZXR1cm47XG4gICAgICAgICAgdGhpcy5ub3RpZnlQcm9taXNlID0gc2NoZWR1bGUoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3VtID0gT2JqZWN0LnZhbHVlcyh0aGlzLnNoYXJkcykucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7XG4gICAgICAgICAgICBvYnNlcnZhYmxlKHtcbiAgICAgICAgICAgICAgZXhpc3RzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiAoKSA9PiBzdW0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5UHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIGluY3JlbWVudEJ5KFxuICAgIHZhbDogZmlyZWJhc2UuZmlyZXN0b3JlLkZpZWxkVmFsdWVcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdXBkYXRlOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0gdGhpcy5maWVsZFxuICAgICAgLnNwbGl0KFwiLlwiKVxuICAgICAgLnJldmVyc2UoKVxuICAgICAgLnJlZHVjZSgodmFsdWUsIG5hbWUpID0+ICh7IFtuYW1lXTogdmFsdWUgfSksIDxhbnk+dmFsKTtcbiAgICByZXR1cm4gdGhpcy5kb2NcbiAgICAgIC5jb2xsZWN0aW9uKFNIQVJEX0NPTExFQ1RJT05fSUQpXG4gICAgICAuZG9jKHRoaXMuc2hhcmRJZClcbiAgICAgIC5zZXQodXBkYXRlLCB7IG1lcmdlOiB0cnVlIH0pO1xuICB9XG5cbiAgcHVibGljIHNoYXJkKCk6IGZpcmViYXNlLmZpcmVzdG9yZS5Eb2N1bWVudFJlZmVyZW5jZSB7XG4gICAgcmV0dXJuIHRoaXMuZG9jLmNvbGxlY3Rpb24oU0hBUkRfQ09MTEVDVElPTl9JRCkuZG9jKHRoaXMuc2hhcmRJZCk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gc2NoZWR1bGU8VD4oZnVuYzogKCkgPT4gVCk6IFByb21pc2U8VD4ge1xuICByZXR1cm4gbmV3IFByb21pc2U8VD4oYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZ1bmMoKTtcbiAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICB9LCAwKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFNoYXJkSWQoY29va2llOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCByZXN1bHQgPSBuZXcgUmVnRXhwKFxuICAgIFwiKD86Xnw7IClcIiArIGVuY29kZVVSSUNvbXBvbmVudChjb29raWUpICsgXCI9KFteO10qKVwiXG4gICkuZXhlYyhkb2N1bWVudC5jb29raWUpO1xuICBpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0WzFdO1xuXG4gIGNvbnN0IHNoYXJkSWQgPSB1dWlkLnY0KCk7XG5cbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSArIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gIGNvbnN0IGV4cGlyZXMgPSBcIjsgZXhwaXJlcz1cIiArIGRhdGUudG9VVENTdHJpbmcoKTtcblxuICBkb2N1bWVudC5jb29raWUgPVxuICAgIGVuY29kZVVSSUNvbXBvbmVudChjb29raWUpICsgXCI9XCIgKyBzaGFyZElkICsgZXhwaXJlcyArIFwiOyBwYXRoPS9cIjtcbiAgcmV0dXJuIHNoYXJkSWQ7XG59XG4iLCJ2YXIgdjEgPSByZXF1aXJlKCcuL3YxJyk7XG52YXIgdjQgPSByZXF1aXJlKCcuL3Y0Jyk7XG5cbnZhciB1dWlkID0gdjQ7XG51dWlkLnYxID0gdjE7XG51dWlkLnY0ID0gdjQ7XG5cbm1vZHVsZS5leHBvcnRzID0gdXVpZDtcbiIsInZhciBybmcgPSByZXF1aXJlKCcuL2xpYi9ybmcnKTtcbnZhciBieXRlc1RvVXVpZCA9IHJlcXVpcmUoJy4vbGliL2J5dGVzVG9VdWlkJyk7XG5cbi8vICoqYHYxKClgIC0gR2VuZXJhdGUgdGltZS1iYXNlZCBVVUlEKipcbi8vXG4vLyBJbnNwaXJlZCBieSBodHRwczovL2dpdGh1Yi5jb20vTGlvc0svVVVJRC5qc1xuLy8gYW5kIGh0dHA6Ly9kb2NzLnB5dGhvbi5vcmcvbGlicmFyeS91dWlkLmh0bWxcblxudmFyIF9ub2RlSWQ7XG52YXIgX2Nsb2Nrc2VxO1xuXG4vLyBQcmV2aW91cyB1dWlkIGNyZWF0aW9uIHRpbWVcbnZhciBfbGFzdE1TZWNzID0gMDtcbnZhciBfbGFzdE5TZWNzID0gMDtcblxuLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9icm9vZmEvbm9kZS11dWlkIGZvciBBUEkgZGV0YWlsc1xuZnVuY3Rpb24gdjEob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG4gIHZhciBiID0gYnVmIHx8IFtdO1xuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgbm9kZSA9IG9wdGlvbnMubm9kZSB8fCBfbm9kZUlkO1xuICB2YXIgY2xvY2tzZXEgPSBvcHRpb25zLmNsb2Nrc2VxICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNsb2Nrc2VxIDogX2Nsb2Nrc2VxO1xuXG4gIC8vIG5vZGUgYW5kIGNsb2Nrc2VxIG5lZWQgdG8gYmUgaW5pdGlhbGl6ZWQgdG8gcmFuZG9tIHZhbHVlcyBpZiB0aGV5J3JlIG5vdFxuICAvLyBzcGVjaWZpZWQuICBXZSBkbyB0aGlzIGxhemlseSB0byBtaW5pbWl6ZSBpc3N1ZXMgcmVsYXRlZCB0byBpbnN1ZmZpY2llbnRcbiAgLy8gc3lzdGVtIGVudHJvcHkuICBTZWUgIzE4OVxuICBpZiAobm9kZSA9PSBudWxsIHx8IGNsb2Nrc2VxID09IG51bGwpIHtcbiAgICB2YXIgc2VlZEJ5dGVzID0gcm5nKCk7XG4gICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgLy8gUGVyIDQuNSwgY3JlYXRlIGFuZCA0OC1iaXQgbm9kZSBpZCwgKDQ3IHJhbmRvbSBiaXRzICsgbXVsdGljYXN0IGJpdCA9IDEpXG4gICAgICBub2RlID0gX25vZGVJZCA9IFtcbiAgICAgICAgc2VlZEJ5dGVzWzBdIHwgMHgwMSxcbiAgICAgICAgc2VlZEJ5dGVzWzFdLCBzZWVkQnl0ZXNbMl0sIHNlZWRCeXRlc1szXSwgc2VlZEJ5dGVzWzRdLCBzZWVkQnl0ZXNbNV1cbiAgICAgIF07XG4gICAgfVxuICAgIGlmIChjbG9ja3NlcSA9PSBudWxsKSB7XG4gICAgICAvLyBQZXIgNC4yLjIsIHJhbmRvbWl6ZSAoMTQgYml0KSBjbG9ja3NlcVxuICAgICAgY2xvY2tzZXEgPSBfY2xvY2tzZXEgPSAoc2VlZEJ5dGVzWzZdIDw8IDggfCBzZWVkQnl0ZXNbN10pICYgMHgzZmZmO1xuICAgIH1cbiAgfVxuXG4gIC8vIFVVSUQgdGltZXN0YW1wcyBhcmUgMTAwIG5hbm8tc2Vjb25kIHVuaXRzIHNpbmNlIHRoZSBHcmVnb3JpYW4gZXBvY2gsXG4gIC8vICgxNTgyLTEwLTE1IDAwOjAwKS4gIEpTTnVtYmVycyBhcmVuJ3QgcHJlY2lzZSBlbm91Z2ggZm9yIHRoaXMsIHNvXG4gIC8vIHRpbWUgaXMgaGFuZGxlZCBpbnRlcm5hbGx5IGFzICdtc2VjcycgKGludGVnZXIgbWlsbGlzZWNvbmRzKSBhbmQgJ25zZWNzJ1xuICAvLyAoMTAwLW5hbm9zZWNvbmRzIG9mZnNldCBmcm9tIG1zZWNzKSBzaW5jZSB1bml4IGVwb2NoLCAxOTcwLTAxLTAxIDAwOjAwLlxuICB2YXIgbXNlY3MgPSBvcHRpb25zLm1zZWNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm1zZWNzIDogbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cbiAgLy8gUGVyIDQuMi4xLjIsIHVzZSBjb3VudCBvZiB1dWlkJ3MgZ2VuZXJhdGVkIGR1cmluZyB0aGUgY3VycmVudCBjbG9ja1xuICAvLyBjeWNsZSB0byBzaW11bGF0ZSBoaWdoZXIgcmVzb2x1dGlvbiBjbG9ja1xuICB2YXIgbnNlY3MgPSBvcHRpb25zLm5zZWNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm5zZWNzIDogX2xhc3ROU2VjcyArIDE7XG5cbiAgLy8gVGltZSBzaW5jZSBsYXN0IHV1aWQgY3JlYXRpb24gKGluIG1zZWNzKVxuICB2YXIgZHQgPSAobXNlY3MgLSBfbGFzdE1TZWNzKSArIChuc2VjcyAtIF9sYXN0TlNlY3MpLzEwMDAwO1xuXG4gIC8vIFBlciA0LjIuMS4yLCBCdW1wIGNsb2Nrc2VxIG9uIGNsb2NrIHJlZ3Jlc3Npb25cbiAgaWYgKGR0IDwgMCAmJiBvcHRpb25zLmNsb2Nrc2VxID09PSB1bmRlZmluZWQpIHtcbiAgICBjbG9ja3NlcSA9IGNsb2Nrc2VxICsgMSAmIDB4M2ZmZjtcbiAgfVxuXG4gIC8vIFJlc2V0IG5zZWNzIGlmIGNsb2NrIHJlZ3Jlc3NlcyAobmV3IGNsb2Nrc2VxKSBvciB3ZSd2ZSBtb3ZlZCBvbnRvIGEgbmV3XG4gIC8vIHRpbWUgaW50ZXJ2YWxcbiAgaWYgKChkdCA8IDAgfHwgbXNlY3MgPiBfbGFzdE1TZWNzKSAmJiBvcHRpb25zLm5zZWNzID09PSB1bmRlZmluZWQpIHtcbiAgICBuc2VjcyA9IDA7XG4gIH1cblxuICAvLyBQZXIgNC4yLjEuMiBUaHJvdyBlcnJvciBpZiB0b28gbWFueSB1dWlkcyBhcmUgcmVxdWVzdGVkXG4gIGlmIChuc2VjcyA+PSAxMDAwMCkge1xuICAgIHRocm93IG5ldyBFcnJvcigndXVpZC52MSgpOiBDYW5cXCd0IGNyZWF0ZSBtb3JlIHRoYW4gMTBNIHV1aWRzL3NlYycpO1xuICB9XG5cbiAgX2xhc3RNU2VjcyA9IG1zZWNzO1xuICBfbGFzdE5TZWNzID0gbnNlY3M7XG4gIF9jbG9ja3NlcSA9IGNsb2Nrc2VxO1xuXG4gIC8vIFBlciA0LjEuNCAtIENvbnZlcnQgZnJvbSB1bml4IGVwb2NoIHRvIEdyZWdvcmlhbiBlcG9jaFxuICBtc2VjcyArPSAxMjIxOTI5MjgwMDAwMDtcblxuICAvLyBgdGltZV9sb3dgXG4gIHZhciB0bCA9ICgobXNlY3MgJiAweGZmZmZmZmYpICogMTAwMDAgKyBuc2VjcykgJSAweDEwMDAwMDAwMDtcbiAgYltpKytdID0gdGwgPj4+IDI0ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDE2ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDggJiAweGZmO1xuICBiW2krK10gPSB0bCAmIDB4ZmY7XG5cbiAgLy8gYHRpbWVfbWlkYFxuICB2YXIgdG1oID0gKG1zZWNzIC8gMHgxMDAwMDAwMDAgKiAxMDAwMCkgJiAweGZmZmZmZmY7XG4gIGJbaSsrXSA9IHRtaCA+Pj4gOCAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRtaCAmIDB4ZmY7XG5cbiAgLy8gYHRpbWVfaGlnaF9hbmRfdmVyc2lvbmBcbiAgYltpKytdID0gdG1oID4+PiAyNCAmIDB4ZiB8IDB4MTA7IC8vIGluY2x1ZGUgdmVyc2lvblxuICBiW2krK10gPSB0bWggPj4+IDE2ICYgMHhmZjtcblxuICAvLyBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGAgKFBlciA0LjIuMiAtIGluY2x1ZGUgdmFyaWFudClcbiAgYltpKytdID0gY2xvY2tzZXEgPj4+IDggfCAweDgwO1xuXG4gIC8vIGBjbG9ja19zZXFfbG93YFxuICBiW2krK10gPSBjbG9ja3NlcSAmIDB4ZmY7XG5cbiAgLy8gYG5vZGVgXG4gIGZvciAodmFyIG4gPSAwOyBuIDwgNjsgKytuKSB7XG4gICAgYltpICsgbl0gPSBub2RlW25dO1xuICB9XG5cbiAgcmV0dXJuIGJ1ZiA/IGJ1ZiA6IGJ5dGVzVG9VdWlkKGIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHYxO1xuIiwidmFyIHJuZyA9IHJlcXVpcmUoJy4vbGliL3JuZycpO1xudmFyIGJ5dGVzVG9VdWlkID0gcmVxdWlyZSgnLi9saWIvYnl0ZXNUb1V1aWQnKTtcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG5cbiAgaWYgKHR5cGVvZihvcHRpb25zKSA9PSAnc3RyaW5nJykge1xuICAgIGJ1ZiA9IG9wdGlvbnMgPT09ICdiaW5hcnknID8gbmV3IEFycmF5KDE2KSA6IG51bGw7XG4gICAgb3B0aW9ucyA9IG51bGw7XG4gIH1cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgdmFyIHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpO1xuXG4gIC8vIFBlciA0LjQsIHNldCBiaXRzIGZvciB2ZXJzaW9uIGFuZCBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGBcbiAgcm5kc1s2XSA9IChybmRzWzZdICYgMHgwZikgfCAweDQwO1xuICBybmRzWzhdID0gKHJuZHNbOF0gJiAweDNmKSB8IDB4ODA7XG5cbiAgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG4gIGlmIChidWYpIHtcbiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgMTY7ICsraWkpIHtcbiAgICAgIGJ1ZltpICsgaWldID0gcm5kc1tpaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ1ZiB8fCBieXRlc1RvVXVpZChybmRzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB2NDtcbiJdLCJzb3VyY2VSb290IjoiIn0=