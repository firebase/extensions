# Copyright 2018 Google LLC
#
# Use of this source code is governed by an MIT-style
# license that can be found in the LICENSE file or at
# https://opensource.org/licenses/MIT.

specVersion: v1beta1
name: hosting-deploy
version: 0.1.0
description: Automatically deploy to Firebase Hosting on Git commit.

apis:
  - firebasehosting.googleapis.com

roles:
  - firebase.developAdmin # Necessary to deploy Firebase Hosting sites

resources:
  - name: deploy
    type: firebasemods.v1beta1.function
    properties:
      runtime: nodejs8
      httpsTrigger: {}
      sourceDirectory: .

env:
  - var: REPO
    label: Github Repository
    required: true
    validationRegex: https://github.com
    validationErrorMessage:
      This mod only supports Github URLs, please enter a URL that starts with
      `https://github.com`
    description: >-
      What is the full URL of the Github repository you want to set up
      Continuous Integration for? *For example:
      https://github.com/firebase/firebase-tools*
  - var: SITE_NAME
    label: Site Name
    default: ${PROJECT_ID}
    description: >-
      What is the name of your site? If your project only has one site, this is
      usually the same as your project ID. You can see your site names at
      https://console.firebase.google.com/project/${PROJECT_ID}/hosting/main.
  - var: BRANCH
    label: Deployment Branch
    default: master
    description: >-
      What branch should trigger deploys to Firebase Hosting?
  - var: DEPLOY_ROOT
    label: Deployment Root
    default: public
    description: >-
      What directory in the repository should contain the source code for
      Firebase Hosting?
