# Copyright 2019 Google LLC
#
# Use of this source code is governed by an MIT-style
# license that can be found in the LICENSE file or at
# https://opensource.org/licenses/MIT.

specVersion: v1beta1
name: remote-config-to-slack
version: 1.0.0

description:
  Listens for changes to Firebase Remote Config, pulls the deltas and posts
  it to Slack.

license: MIT

roles:
  - role: firebase.growthAdmin
    reason: Firebase Remote Config requires growth admin privileges.

apis:
  - api: firebaseremoteconfig.googleapis.com

params:
  - param: SLACK_WEBHOOK_URL
    label: Slack Webhook URL
    description:
      The Webhook URL provided by Slack to post into a channel (e.g.
      `https://hooks.slack.com/services/FOO/BAR/KEY`; learn more at
      `https://api.slack.com/incoming-webhooks` )
    required: true

resources:
  - name: showConfigDiff
    type: firebasemods.v1beta1.function
    properties:
      eventTrigger:
        eventType: google.firebase.remoteconfig.update
        resource: projects/${PROJECT_ID}
