# Erase User Data When Their Account is Deleted

## Summary

When a Firebase Authentication user is deleted from the Firebase project where this mod is installed, their data that is stored in Realtime Database, Cloud Firestore, and/or Cloud Storage will be automatically deleted as well. This mod can help an app respect user privacy and fulfill compliance requirements, but using it does not guarantee compliance with government and industry regulations.

## Details

This mod requires that users of the app are managed through [Firebase Authentication](https://firebase.google.com/docs/auth/). It also requires that user data is organized in schemas that contain the User IDs generated by Firebase Authentication.

### Configuration

This Mod has 3 optional environment variables for configuration:

- `FIRESTORE_PATHS`
- `RTDB_PATHS`
- `STORAGE_PATHS`

See `mod.yaml` for detailed descriptions of these variables. The mod consumer can leave any of these variables blank if they are not using that product.

### Required Roles

Since this Mod needs to be able to delete data from Firestore, Realtime Database, and Cloud Storage, it requires the `firebase.developAdmin` role, which gives the mod access to the Firebase "develop" products. You can learn more about this role at https://firebase.google.com/docs/projects/iam/roles#develop_roles.

### Resources Created

This Mod creates one resource: a Cloud Function that triggers for every deleted user.

Once triggered, the function looks at the environment variables that have been configured and tries to delete data from Realtime Database, Firestore, and Storage. It will skip one or more of the products if the corresponding environment variable is blank. The Cloud Funciton is implemented by collecting a promise for every deletion event; only when all promises resolve is the data deletion considered complete. The mod consumer can look at their Cloud Functions logs to see deletion completions and any error messges.

### Privacy

This mod stores the environment variables in the source of the Cloud Function.

### Potential Costs

_Disclaimer: without knowing your exact use, it's impossible to say exactly what this may cost._

This mod may generate costs due to:

- **Cloud Functions Usage**: Each time a user is deleted, a Cloud Function invocation will occur. If the free quota for Cloud Functions is consumed, then it will generate cost for the Firebase Project.
- **Firestore Usage**: Each invocation of the Cloud Function potentially results in document deletions. If the free quota for Firestore document deletion is consumed, then it will generate cost for the Firebase Project.

See more details at https://firebase.google.com/pricing.

### Copyright

Copyright 2018 Google LLC

Use of this source code is governed by an MIT-style
license that can be found in the LICENSE file or at
https://opensource.org/licenses/MIT.
